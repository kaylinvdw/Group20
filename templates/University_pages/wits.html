{% extends "base.html" %}

{% block title %}University of Witswaterstrand{% endblock %}

{% block content %}

<br>
<div class="container-fluid">
    <div class="row">
        <div class="col-12" style="min-height: 140px; background-color:lavender; border-radius: 8px; display: flex; flex-direction: column; justify-content: flex-start; width: 100%; ">
            <div style="display: flex; align-items: center; justify-content: space-between; gap: 20px;">
                <div style="display: flex; align-items: center; gap: 20px;">
                    <img src="{{ url_for('static', filename='uni_logos/wits.webp') }}" alt="Wits" height="140" style="width:auto;">
                    <div style="font-size: 31px; font-weight: bold; color: rgb(22, 1, 64); text-align: left;">
                        University of Witwatersrand Johannesburg
                    </div>
                </div>
                <button class="btn btn-link" type="button" onclick="window.location.href='https://www.wits.ac.za/faculties-and-schools/';">
                    Click here to visit the Wits' official website.
                </button>
            </div>
        </div>
    </div>
</div>

<!-- General Filtering Info -->
<div id="filtering info" class="row" style="margin-top: 30px; justify-content: center; display: flex;">
    <div class="col-sm-10 text-center">
        <span style="font-size: 18px; color: rgb(22, 1, 64); font-weight: 600;">
            Please select from the dropboxes below your current <strong style="color: plum;">faculty</strong> of studies, <strong style="color: plum;">level</strong> of studies, <strong style="color: plum;">degree</strong> and <strong style="color: plum;">year</strong> of studies to filter out your textbook requirements.  
        </span>
    </div>
</div>  
<br>

<!--Course selection-->
<div class="container-fluid">
    <div class="row justify-content-center">  
        <div class="col-lg-8 col-md-10">
            <div class="d-grid gap-4">
                
                <!-- Faculty Dropdown -->
                <div class="dropdown-container">
                    <label class="selection-label">Faculty of Studies</label>
                    <div class="dropdown selection-dropdown">
                        <button id="facultyBtn" class="btn dropdown-toggle w-100 text-start d-flex justify-content-between align-items-center" type="button" data-bs-toggle="dropdown" aria-expanded="false" style="background-color: transparent; border: none; color: white; font-size: 18px; font-weight: 600;">
                            Choose your faculty of studies
                        </button>
                        <ul class="dropdown-menu dropdown-menu-end w-100 custom-dropdown-menu">
                            <li><a class="dropdown-item" href="#" onclick="selectFaculty('Commerce, Law and Management'); return false;">Commerce, Law and Management</a></li>
                            <li><a class="dropdown-item" href="#" onclick="selectFaculty('Engineering and the Built Environment'); return false;">Engineering and the Built Environment</a></li>
                            <li><a class="dropdown-item" href="#" onclick="selectFaculty('Health Sciences'); return false;">Health Sciences</a></li>
                            <li><a class="dropdown-item" href="#" onclick="selectFaculty('Humanities'); return false;">Humanities</a></li>
                            <li><a class="dropdown-item" href="#" onclick="selectFaculty('Science'); return false;">Science</a></li>
                        </ul>
                    </div>
                </div>

                <!-- Degree Dropdown -->
                <div class="dropdown-container">
                    <label class="selection-label">Degree Program</label>
                    <div class="dropdown selection-dropdown">
                        <button id="degreeBtn" class="btn dropdown-toggle w-100 text-start d-flex justify-content-between align-items-center" type="button" data-bs-toggle="dropdown" aria-expanded="false" style="background-color: transparent; border: none; color: white; font-size: 18px; font-weight: 600;">
                            Choose your degree
                        </button>
                        <ul class="dropdown-menu dropdown-menu-end w-100 custom-dropdown-menu">
                            <li><a class="dropdown-item" href="#" onclick="selectDegree('Architecture and Planning'); return false;">Architecture and Planning</a></li>
                            <li><a class="dropdown-item" href="#" onclick="selectDegree('Civil and Environmental Engineering'); return false;">Civil and Environmental Engineering</a></li>
                            <li><a class="dropdown-item" href="#" onclick="selectDegree('Chemical and Metallurgical Engineering'); return false;">Chemical and Metallurgical Engineering</a></li>
                            <li><a class="dropdown-item" href="#" onclick="selectDegree('Construction, Economics and Management'); return false;">Construction, Economics and Management</a></li>
                            <li><a class="dropdown-item" href="#" onclick="selectDegree('Electrical and Information Engineering'); return false;">Electrical and Information Engineering</a></li>
                            <li><a class="dropdown-item" href="#" onclick="selectDegree('Mechanical, Industrial and Aeronautical Engineering'); return false;">Mechanical, Industrial and Aeronautical Engineering</a></li>
                            <li><a class="dropdown-item" href="#" onclick="selectDegree('Mining Engineering'); return false;">Mining Engineering</a></li>
                        </ul>
                    </div>
                </div>

                <!-- Level Dropdown -->
                <div class="dropdown-container">
                    <label class="selection-label">Level of Studies</label>
                    <div class="dropdown selection-dropdown">
                        <button id="levelBtn" class="btn dropdown-toggle w-100 text-start d-flex justify-content-between align-items-center" type="button" data-bs-toggle="dropdown" aria-expanded="false" style="background-color: transparent; border: none; color: white; font-size: 18px; font-weight: 600;">
                            Choose your level of studies
                        </button>
                        <ul class="dropdown-menu dropdown-menu-end w-100 custom-dropdown-menu">
                            <li><a class="dropdown-item" href="#" onclick="selectLevel('Masters'); return false;">Masters</a></li>
                            <li><a class="dropdown-item" href="#" onclick="selectLevel('Honours'); return false;">Honours</a></li>
                            <li><a class="dropdown-item" href="#" onclick="selectLevel('Undergraduate'); return false;">Undergraduate</a></li>
                        </ul>
                    </div>
                </div>


                <!-- Year Dropdown -->
                <div class="dropdown-container" id="yearDropdownContainer" style="display: none;">
                    <label class="selection-label">Year of Studies</label>
                    <div class="dropdown selection-dropdown">
                        <button id="yearBtn" class="btn dropdown-toggle w-100 text-start d-flex justify-content-between align-items-center" type="button" data-bs-toggle="dropdown" aria-expanded="false" style="background-color: transparent; border: none; color: white; font-size: 18px; font-weight: 600;">
                            Choose your year of studies
                        </button>
                        <ul class="dropdown-menu w-100 custom-dropdown-menu">
                            <li><a class="dropdown-item" href="#" onclick="selectYear('1st Year'); return false;">1st Year</a></li>
                            <li><a class="dropdown-item" href="#" onclick="selectYear('2nd Year'); return false;">2nd Year</a></li>
                            <li><a class="dropdown-item" href="#" onclick="selectYear('3rd Year'); return false;">3rd Year</a></li>
                            <li><a class="dropdown-item" href="#" onclick="selectYear('4th Year'); return false;">4th Year</a></li>
                        </ul>
                    </div>
                </div>

                <!-- Filter Button -->
                <div class="text-center mt-4">
                    <button class="btn btn-lg" onclick="applyFilters()" style="background: plum; color: black; padding: 15px 50px; font-size: 20px; font-weight: 600; border: none; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); transition: all 0.3s ease;">
                        Filter Textbooks
                    </button>
                </div>

            </div>
        </div>
    </div>
</div>

<br><br>

{% endblock %}

{% block scripts %}
<script>
    // Store selections
    let selections = {
        faculty: '',
        level: '',
        degree: '',
        year: ''
    };

    function selectFaculty(faculty) {
        selections.faculty = faculty;
        document.getElementById('facultyBtn').textContent = faculty;
        console.log('Selected faculty:', faculty);
    }

    function selectLevel(level) {
        selections.level = level;
        document.getElementById('levelBtn').textContent = level;
        console.log('Selected level:', level);
        
        // Show/hide year dropdown based on level selection
        const yearContainer = document.getElementById('yearDropdownContainer');
        const yearMenu = yearContainer.querySelector('.dropdown-menu');
        
        if (level === 'Undergraduate') {
            // Show all 4 years for Undergraduate
            yearMenu.innerHTML = `
                <li><a class="dropdown-item" href="#" onclick="selectYear('1st Year'); return false;">1st Year</a></li>
                <li><a class="dropdown-item" href="#" onclick="selectYear('2nd Year'); return false;">2nd Year</a></li>
                <li><a class="dropdown-item" href="#" onclick="selectYear('3rd Year'); return false;">3rd Year</a></li>
                <li><a class="dropdown-item" href="#" onclick="selectYear('4th Year'); return false;">4th Year</a></li>
            `;
            yearContainer.style.display = 'block';
        } else if (level === 'Masters') {
            // Show only 2 years for Masters
            yearMenu.innerHTML = `
                <li><a class="dropdown-item" href="#" onclick="selectYear('Year 1'); return false;">Year 1</a></li>
                <li><a class="dropdown-item" href="#" onclick="selectYear('Year 2'); return false;">Year 2</a></li>
            `;
            yearContainer.style.display = 'block';
        } else {
            yearContainer.style.display = 'none';
            // Reset year selection if switching away from Undergraduate/Masters
            selections.year = '';
            document.getElementById('yearBtn').textContent = 'Choose your year of studies';
        }
        
        // Reset year selection when changing level
        if (level === 'Undergraduate' || level === 'Masters') {
            selections.year = '';
            document.getElementById('yearBtn').textContent = 'Choose your year of studies';
        }
    }

    function selectDegree(degree) {
        selections.degree = degree;
        document.getElementById('degreeBtn').textContent = degree;
        console.log('Selected degree:', degree);
    }

    function selectYear(year) {
        selections.year = year;
        document.getElementById('yearBtn').textContent = year;
        console.log('Selected year:', year);
        console.log('All selections:', selections);
    }

    function applyFilters() {
        console.log('Applying filters with selections:', selections);
        
        // Check if all required selections are made
        if (!selections.faculty || !selections.level || !selections.degree) {
            alert('Please make all required selections before filtering.');
            return;
        }
        
        // Check if year is required (only for Undergraduate)
        if (selections.level === 'Undergraduate' && !selections.year) {
            alert('Please select your year of studies.');
            return;
        }
        
        // Here you can add your filtering logic
        let filterMessage = `Filtering textbooks for:\nFaculty: ${selections.faculty}\nLevel: ${selections.level}\nDegree: ${selections.degree}`;
        if (selections.level === 'Undergraduate') {
            filterMessage += `\nYear: ${selections.year}`;
        }
        alert(filterMessage);
        
        // Add your actual filtering functionality here
        // For example, redirect to results page or load filtered content
    }

    // Handle z-index for dropdowns
    document.addEventListener('DOMContentLoaded', function() {
        const containers = document.querySelectorAll('.dropdown-container');
        
        containers.forEach(container => {
            const dropdownElement = container.querySelector('.dropdown');
            
            dropdownElement.addEventListener('show.bs.dropdown', function() {
                containers.forEach(c => c.classList.remove('active'));
                container.classList.add('active');
            });
            
            dropdownElement.addEventListener('hide.bs.dropdown', function() {
                container.classList.remove('active');
            });
        });
    });
</script>
{% endblock %}